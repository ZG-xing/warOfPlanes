"use strict";var gameEngine={ele:null,allBullets:[],allEnemies:[],totalScore:0,init:function(){return this.ele=document.getElementById("main"),this},start:function(){console.log("start"),this.loading(function(){console.log("游戏正式开始！"),myPlane.init().move(),myPlane.fire(),gameEngine.listenKeyboard(),gameEngine.createEnemy(),gameEngine.crash(),gameEngine.moveBackground()})},loading:function(e){var n=document.createElement("div");this.ele.appendChild(n),n.className="logo";var l=document.createElement("div");this.ele.appendChild(l),l.className="load";var t=["images/loading1.png","images/loading2.png","images/loading3.png"],a=0,o=setInterval(function(){a>=5?(clearInterval(o),gameEngine.ele.removeChild(n),gameEngine.ele.removeChild(l),e&&e()):l.style.background="url("+t[++a%3]+")"},500)},listenKeyboard:function(){var e=0,n=0;onkeydown=function(l){37==(l=l||event).keyCode?e=-10:38==l.keyCode?n=-10:39==l.keyCode?e=10:40==l.keyCode&&(n=10)},onkeyup=function(l){37==l.keyCode||39==l.keyCode?e=0:38!=l.keyCode&&40!=l.keyCode||(n=0)},setInterval(function(){var l=myPlane.ele.offsetLeft+e,t=myPlane.ele.offsetTop+n;l<0?l=0:l>gameEngine.ele.offsetWidth-myPlane.ele.offsetWidth&&(l=gameEngine.ele.offsetWidth-myPlane.ele.offsetWidth),t<0?t=0:t>gameEngine.ele.offsetHeight-myPlane.ele.offsetHeight&&(t=gameEngine.ele.offsetHeight-myPlane.ele.offsetHeight),myPlane.ele.style.left=l+"px",myPlane.ele.style.top=t+"px"},30)},createEnemy:function(){setInterval(function(){if(Math.random()>.8){new Enemy(1).init().move()}},6e3),setInterval(function(){if(Math.random()>.7){new Enemy(2).init().move()}},1e3),setInterval(function(){if(Math.random()>.5){new Enemy(3).init().move()}},1e3)},crash:function(){var e=setInterval(function(){for(var n=0;n<gameEngine.allEnemies.length;n++){for(var l=0;l<gameEngine.allBullets.length;l++)isCrash(gameEngine.allEnemies[n].ele,gameEngine.allBullets[l].ele)&&(gameEngine.allBullets[l].boom(),gameEngine.allBullets.splice(l,1),gameEngine.allEnemies[n].hurt());if(isCrash(gameEngine.allEnemies[n].ele,myPlane.ele)){clearInterval(e),myPlane.boom(function(){var e=prompt("请留下您的大名， 您当前的分数是:"+gameEngine.totalScore);ajax({type:"post",url:"http://60.205.181.47/myPHPCode4/uploadScore.php",data:{name:e,score:gameEngine.totalScore},success:function(e){console.log("提交成功: "+e),location.href="rank.html"}})});break}}},30)},moveBackground:function(){var e=0;setInterval(function(){gameEngine.ele.style.backgroundPositionY=e+++"px"},30)}};